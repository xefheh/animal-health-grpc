START TRANSACTION;

CREATE TABLE "Animals" (
                           "RegNumber" integer GENERATED BY DEFAULT AS IDENTITY,
                           "Name" text NULL,
                           "OwnerFeatures" text NULL,
                           "BirthDate" timestamp with time zone NOT NULL,
                           "BehaviourFeatures" text NULL,
                           "Sex" text NULL,
                           "Type" text NULL,
                           "ChipNumber" integer NOT NULL,
                           CONSTRAINT "PK_Animals" PRIMARY KEY ("RegNumber")
);

CREATE TABLE "Diseases" (
                            "Number" integer GENERATED BY DEFAULT AS IDENTITY,
                            "Name" text NULL,
                            CONSTRAINT "PK_Diseases" PRIMARY KEY ("Number")
);

CREATE TABLE "Localities" (
                              "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                              "Name" text NULL,
                              CONSTRAINT "PK_Localities" PRIMARY KEY ("Id")
);

CREATE TABLE "Users" (
                         "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                         "Name" text NULL,
                         "Login" text NULL,
                         "Password" text NULL,
                         CONSTRAINT "PK_Users" PRIMARY KEY ("Id")
);

CREATE TABLE "Vaccines" (
                            "Serial" integer GENERATED BY DEFAULT AS IDENTITY,
                            "Name" text NULL,
                            "Price" real NOT NULL,
                            CONSTRAINT "PK_Vaccines" PRIMARY KEY ("Serial")
);

CREATE TABLE "Organizations" (
                                 "Tin" text NOT NULL,
                                 "Trc" text NOT NULL,
                                 "Name" text NULL,
                                 "Type" text NULL,
                                 "Feature" text NULL,
                                 "LocalityId" integer NULL,
                                 CONSTRAINT "PK_Organizations" PRIMARY KEY ("Tin"),
                                 CONSTRAINT "FK_Organizations_Localities_LocalityId" FOREIGN KEY ("LocalityId") REFERENCES "Localities" ("Id")
);

CREATE TABLE "Contracts" (
                             "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                             "Number" integer NOT NULL,
                             "ConclusionDate" timestamp with time zone NOT NULL,
                             "EndDate" timestamp with time zone NOT NULL,
                             "ExecutorTin" text NOT NULL,
                             "CustomerTin" text NOT NULL,
                             CONSTRAINT "PK_Contracts" PRIMARY KEY ("Id"),
                             CONSTRAINT "FK_Contracts_Organizations_CustomerTin" FOREIGN KEY ("CustomerTin") REFERENCES "Organizations" ("Tin") ON DELETE CASCADE,
                             CONSTRAINT "FK_Contracts_Organizations_ExecutorTin" FOREIGN KEY ("ExecutorTin") REFERENCES "Organizations" ("Tin") ON DELETE CASCADE
);

CREATE TABLE "Roles" (
                         "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                         "OrganizationTin" text NOT NULL,
                         "UserId" integer NOT NULL,
                         CONSTRAINT "PK_Roles" PRIMARY KEY ("Id"),
                         CONSTRAINT "FK_Roles_Organizations_OrganizationTin" FOREIGN KEY ("OrganizationTin") REFERENCES "Organizations" ("Tin") ON DELETE CASCADE,
                         CONSTRAINT "FK_Roles_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("Id") ON DELETE CASCADE
);

CREATE TABLE "Inspections" (
                               "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                               "FeatureBehaviour" text NULL,
                               "AnimalCondition" text NULL,
                               "Temperature" real NOT NULL,
                               "SkinCover" text NULL,
                               "FurCondition" text NULL,
                               "Injures" text NULL,
                               "IsNeedOperations" boolean NOT NULL,
                               "Manipulations" text NULL,
                               "Treatment" text NULL,
                               "Date" timestamp with time zone NOT NULL,
                               "UserId" integer NOT NULL,
                               "InspectedAnimalRegNumber" integer NOT NULL,
                               "ContractId" integer NOT NULL,
                               "DiseaseNumber" integer NULL,
                               CONSTRAINT "PK_Inspections" PRIMARY KEY ("Id"),
                               CONSTRAINT "FK_Inspections_Animals_InspectedAnimalRegNumber" FOREIGN KEY ("InspectedAnimalRegNumber") REFERENCES "Animals" ("RegNumber") ON DELETE CASCADE,
                               CONSTRAINT "FK_Inspections_Contracts_ContractId" FOREIGN KEY ("ContractId") REFERENCES "Contracts" ("Id") ON DELETE CASCADE,
                               CONSTRAINT "FK_Inspections_Diseases_DiseaseNumber" FOREIGN KEY ("DiseaseNumber") REFERENCES "Diseases" ("Number"),
                               CONSTRAINT "FK_Inspections_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("Id") ON DELETE CASCADE
);

CREATE TABLE "PricePairs" (
                              "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                              "LocalityId" integer NOT NULL,
                              "ContractId" integer NOT NULL,
                              "Price" real NOT NULL,
                              CONSTRAINT "PK_PricePairs" PRIMARY KEY ("Id"),
                              CONSTRAINT "FK_PricePairs_Contracts_ContractId" FOREIGN KEY ("ContractId") REFERENCES "Contracts" ("Id") ON DELETE CASCADE,
                              CONSTRAINT "FK_PricePairs_Localities_LocalityId" FOREIGN KEY ("LocalityId") REFERENCES "Localities" ("Id") ON DELETE CASCADE
);

CREATE TABLE "Vaccinations" (
                                "Id" integer GENERATED BY DEFAULT AS IDENTITY,
                                "Date" timestamp with time zone NOT NULL,
                                "ExpirationDate" timestamp with time zone NOT NULL,
                                "AnimalRegNumber" integer NOT NULL,
                                "UserId" integer NOT NULL,
                                "VaccineSerial" integer NOT NULL,
                                "ContractId" integer NOT NULL,
                                CONSTRAINT "PK_Vaccinations" PRIMARY KEY ("Id"),
                                CONSTRAINT "FK_Vaccinations_Animals_AnimalRegNumber" FOREIGN KEY ("AnimalRegNumber") REFERENCES "Animals" ("RegNumber") ON DELETE CASCADE,
                                CONSTRAINT "FK_Vaccinations_Contracts_ContractId" FOREIGN KEY ("ContractId") REFERENCES "Contracts" ("Id") ON DELETE CASCADE,
                                CONSTRAINT "FK_Vaccinations_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("Id") ON DELETE CASCADE,
                                CONSTRAINT "FK_Vaccinations_Vaccines_VaccineSerial" FOREIGN KEY ("VaccineSerial") REFERENCES "Vaccines" ("Serial") ON DELETE CASCADE
);

CREATE INDEX "IX_Contracts_CustomerTin" ON "Contracts" ("CustomerTin");

CREATE INDEX "IX_Contracts_ExecutorTin" ON "Contracts" ("ExecutorTin");

CREATE INDEX "IX_Inspections_ContractId" ON "Inspections" ("ContractId");

CREATE INDEX "IX_Inspections_DiseaseNumber" ON "Inspections" ("DiseaseNumber");

CREATE INDEX "IX_Inspections_InspectedAnimalRegNumber" ON "Inspections" ("InspectedAnimalRegNumber");

CREATE INDEX "IX_Inspections_UserId" ON "Inspections" ("UserId");

CREATE INDEX "IX_Organizations_LocalityId" ON "Organizations" ("LocalityId");

CREATE INDEX "IX_PricePairs_ContractId" ON "PricePairs" ("ContractId");

CREATE INDEX "IX_PricePairs_LocalityId" ON "PricePairs" ("LocalityId");

CREATE INDEX "IX_Roles_OrganizationTin" ON "Roles" ("OrganizationTin");

CREATE INDEX "IX_Roles_UserId" ON "Roles" ("UserId");

CREATE INDEX "IX_Vaccinations_AnimalRegNumber" ON "Vaccinations" ("AnimalRegNumber");

CREATE INDEX "IX_Vaccinations_ContractId" ON "Vaccinations" ("ContractId");

CREATE INDEX "IX_Vaccinations_UserId" ON "Vaccinations" ("UserId");

CREATE INDEX "IX_Vaccinations_VaccineSerial" ON "Vaccinations" ("VaccineSerial");

INSERT INTO "Animals" ("RegNumber", "Name", "OwnerFeatures", "BirthDate", "BehaviourFeatures", "Sex", "Type", "ChipNumber") VALUES
                                                                                                                                (1, 'Кошка 1', 'sdsdsds', '01-02-2002', 'sdf', 'М', 'Собака', 123),
                                                                                                                                (2, 'Собака 1', 'sdsdsds', '01-02-2002', 'sdf', 'Ж', 'Енот', 1234),
                                                                                                                                (3, 'Собака 2', 'sdsdsds', '01-02-2002', 'sdf', 'М', 'Кошка', 228),
                                                                                                                                (4, 'Кошка 2', 'sdsdsds', '01-02-2002', 'sdf', 'М', 'Гусь', 322),
                                                                                                                                (5, 'Кошка 3', 'sdsdsds', '01-02-2002', 'sdf', 'М', 'Собака', 1488);

INSERT INTO "Localities"("Id", "Name") VALUES
                                           (1, 'Тюмень'),
                                           (2, 'Москва'),
                                           (3, 'Волгоград');

INSERT INTO "Organizations"("Tin", "Trc", "Name", "Type", "Feature", "LocalityId") VALUES
                                                                                       (1, 1, 'Лучший друг', 'Ветклиника', 'Ветклиника', 1),
                                                                                       (2, 1, 'Семечка', 'Ветклиника', 'Ветклиника', 2),
                                                                                       (3, 1, 'ZOOМИР', 'Ветклиника', 'Ветклиника', 3);

INSERT INTO "Contracts"("Id", "Number", "ConclusionDate", "EndDate", "ExecutorTin", "CustomerTin") VALUES
                                                                                                       (DEFAULT, 1, '01-02-2002', '01-03-2002', 1, 2),
                                                                                                       (DEFAULT, 2, '01-02-2002', '01-03-2002', 3, 1),
                                                                                                       (DEFAULT, 3, '01-02-2002', '01-03-2002', 1, 2);

INSERT INTO "Users"("Id", "Name", "Login", "Password") VALUES
                                                           (1, 'Вова', 'admin', 'admin1'),
                                                           (2, 'Пиво', 'admin', 'admin1'),
                                                           (3, 'Юзер', '123', '123'),
                                                           (4, 'Имя', 'asd', 'asd'),
                                                           (5, 'Фамилия', 'asd', 'asd');

INSERT INTO "Roles"("Id", "OrganizationTin", "UserId") VALUES
                                                           (1, 1, 1),
                                                           (2, 2, 2),
                                                           (3, 3, 3),
                                                           (4, 1, 2),
                                                           (5, 2, 1);

INSERT INTO "Vaccines"("Serial", "Name", "Price") VALUES
    (1, 'Бешенство', 500);

INSERT INTO "Vaccinations"("Id", "Date", "ExpirationDate", "AnimalRegNumber", "UserId", "VaccineSerial", "ContractId") VALUES
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 1, 3, 1, 1),
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 2, 3, 1, 1),
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 3, 3, 1, 1),
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 3, 3, 1, 1),
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 1, 3, 1, 1),
                                                                                                                           (DEFAULT, '01-02-2012', '01-03-2012', 2, 3, 1, 1);

INSERT INTO "Diseases"("Number", "Name") VALUES
    (1, 'Бешенство');

INSERT INTO "Inspections"("Id", "FeatureBehaviour", "AnimalCondition", "Temperature", "SkinCover", "FurCondition", "Injures", "IsNeedOperations",
                          "Manipulations", "Treatment", "Date", "UserId", "InspectedAnimalRegNumber", "ContractId", "DiseaseNumber") VALUES
                                                                                                                                         (DEFAULT, 'авпва', 'ываыа', 1293, 'ывываыв', 'ываываа', 'ываываыва', '1', 'sdfs', 'sdfsdf', '01-03-2012', 1, 1, 1, 1),
                                                                                                                                         (DEFAULT, 'авпва', 'ываыа', 1293, 'ывываыв', 'ываываа', 'ываываыва', '1', 'sdfs', 'sdfsdf', '01-03-2012', 1, 1, 1, 1),
                                                                                                                                         (DEFAULT, 'авпва', 'ываыа', 1293, 'ывываыв', 'ываываа', 'ываываыва', '1', 'sdfs', 'sdfsdf', '01-03-2012', 1, 1, 2, 1),
                                                                                                                                         (DEFAULT, 'авпва', 'ываыа', 1293, 'ывываыв', 'ываываа', 'ываываыва', '1', 'sdfs', 'sdfsdf', '01-03-2012', 1, 1, 2, 1),
                                                                                                                                         (DEFAULT, 'авпва', 'ываыа', 1293, 'ывываыв', 'ываываа', 'ываываыва', '1', 'sdfs', 'sdfsdf', '01-03-2012', 1, 1, 3, 1);

COMMIT;
